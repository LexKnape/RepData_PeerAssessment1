---
## "Reproducible Research: Peer Assessment 1"

---

### **Loading and preprocessing the data**
Load Libraries ddplyr and ggplot2.

```{r Load libraries}
library("plyr")
library("ggplot2")
```

Unzip the activity.zip and read the activity.csv file
```{r Unzip and read.csv}
# Unzip the activit.zip file
unzip("activity.zip")
#Read activity.csv file
activity <- read.csv("activity.csv", header=T)
```

The class for Activity$date must be date instead of the current class factor
```{r Set the calss of date}
class(activity$date)
# Class of date is a factor needs to be date.
activityDate <-transform(activity, date = as.Date(date))
class(activityDate$date)
# Class date is Date
```

## **What is mean total number of steps taken per day?**

before we can calculate the number of steps per day we must
set the class for Activity$date to be date instead of the current class factor
```{r Set the calss of date}
class(activity$date)
# Class of date is a factor needs to be date.
activityDate <-transform(activity, date = as.Date(date))
class(activityDate$date)
# Class date is Date
```

now we can calculate the total number of steps per day.
```{r mean total number of steps per day}
MstepsPerDay <- ddply(activity, ~date, summarise, steps = sum(steps))
```

In order to show the number of steps per day I will show the result of the stepsPerDay in a histogram
```{r Histogram mean tot. steps per day }
p <- ggplot (MstepsPerDay, aes (steps))
p <- p + geom_histogram(fill = "yellow", color = "black") + theme_bw(base_family = "Verdana")
p + ggtitle ("Total number of steps per day")
p + labs(x = "Step per day", y = "Number of times it occured")
```

In order to show the number of steps per day I will show the result of the stepsPerDay in a histogram
```{r Histogram mean tot. steps per day }
p <- ggplot (MstepsPerDay, aes (steps))
p <- p + geom_histogram(fill = "yellow", color = "black") + theme_bw(base_family = "Verdana")
p + ggtitle ("Total number of steps per day")
p + labs(x = "Step per day", y = "Number of times it occured")
```
The plot shows missing values and to calculate the mean we must get ride of these

Get ride of the missing values in DATA MstepsPerDay and calculate number of steps
```{r Clean missing values}
activityStepsClean <- activity[complete.cases(activity[,1]), ]
stepsPerDayClean <- ddply(activityStepsClean, ~date, summarise, steps = sum(steps))
```

Finally we calculate the mean of the total number os steps per day.
```{r Mean tot steps per Day without missing values}
meanstepsPerDayClean <- mean(stepsPerDayClean$steps)
```

The mean total number of steps taken per day is 10766.

## What is the average daily activity pattern?

As the device collects data at 5 minute intervals through out the day we need a plot (time series) 
of the activity to get a feel. First calculate the steps taken per interval

```{r Average interval per `steps}
StepsPerIntervalAverage <- ddply ( activity, ~interval, summarise, mean = mean (steps, na.rm=T))
```

I make a time series plot (<code>i.e. type = "l"</code>) of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r Histogram mean tot. steps per day }
p <- ggplot (StepsPerIntervalAverageClean, aes (interval,mean))
p + geom_line(col= "red") + theme_bw(base_family = "Verdana"))
```

The Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
The 835 5-minute interval contains the maximum number of steps on average across all the days in the dataset


## Imputing missing values
Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
The dataset activity with all values shows 17.568 observation while activityClean shows 15.264 observations 
which results in 2.304 missing vales

I will test the above via an r script.
```{r Missing values }
RowsOfNAs <- is.na(activity$steps)
summary(RowsOfNA2s)
```
The double check shows the summary of NA's TRUE 2.304. The total number of missing values is 2.304



## Are there differences in activity patterns between weekdays and weekends?
